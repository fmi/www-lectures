<!DOCTYPE html><html lang="bg"><head><meta charset="utf-8" /><!--[if lt IE 9]><script src="js/html5shim.js"></script><![endif]--><link href="css/styles.css" rel="stylesheet" /><link href="css/pygments.css" rel="stylesheet" /><script src="js/analytics.js"></script><title>01. Динамично генериране на HTML</title></head><body><header><h1>01. Динамично генериране на HTML</h1><nav><ul><li><button id="prev-btn" title="Previous slide">Previous Slide</button></li><li><span id="slide-number"></span> / <span id="slide-total"></span></li><li><button id="next-btn" title="Next Slide">Next Slide</button></li></ul></nav></header><div id="deck"><section><hgroup><h1>01. Динамично генериране на HTML</h1></hgroup></section><section>
<hgroup><h1>Клинет-сървър</h1></hgroup>
<img src="images/client_net.jpg" style="width: 60%" /></section>
<section>
<hgroup><h1>Какво ще използваме</h1></hgroup>
<img src="images/java.jpg" width="400" /><h2 align="center">+</h2><img src="images/spark-java.png" width="400" /></section>
<section>
<hgroup><h1>Как изглежда при нас</h1></hgroup>
<img src="images/spark-graph.png" width="600" /></section>
<section>
<hgroup><h1>Какво се случва</h1></hgroup>
<ul><li class="action">Браузърът изпраща HTTP заявка към сървъра.</li><li class="action">Сървърът я обработва.</li><li class="action">Той може да прочете информация от база от данни/файлова система/друг сървър.</li><li class="action">Накрая генерира отговор под определен формат (например HTML).</li></ul></section>
<section>
<hgroup><h1>Пример за Java + Spark</h1></hgroup>
<div class="highlight"><pre><span></span><span class="c1">// Sparkjava</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">spark</span><span class="o">.</span><span class="na">Spark</span><span class="o">.*;</span>

<span class="c1">// основен клас</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorld</span> <span class="o">{</span>

    <span class="c1">// начало на програмата</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// http://localhost:4567/hello</span>
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/hello&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">res</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="s">&quot;Hello World&quot;</span><span class="o">);</span>

    <span class="o">}</span>

<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>HTTP методи</h1></hgroup>
<div class="highlight"><pre><span></span><span class="n">get</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="c1">// Покажете нещо</span>
<span class="o">});</span>

<span class="n">post</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="c1">// Създайте нещо</span>
<span class="o">});</span>

<span class="n">put</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="c1">// Променете нещо</span>
<span class="o">});</span>

<span class="n">delete</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="c1">// Изтрийте нещо</span>
<span class="o">});</span>

<span class="n">options</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="c1">// Проверете нещо</span>
<span class="o">});</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>Смяна на порт</h1></hgroup>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NonDefaultPort</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// По подразбиране на 4567</span>
        <span class="n">port</span><span class="o">(</span><span class="mi">5678</span><span class="o">);</span>          
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/hello&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>Използване на параметри в пътя</h1></hgroup>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PathParams</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/users/:name&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;Selected user: &quot;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="na">params</span><span class="o">(</span><span class="s">&quot;:name&quot;</span><span class="o">)</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
<h2>http://localhost:4567/users/foo -> "Selected user: foo"</h2></section>
<section>
<hgroup><h1>Пренасочване</h1></hgroup>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Redirector</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/redirect-from&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">response</span><span class="o">.</span><span class="na">redirect</span><span class="o">(</span><span class="s">&quot;/redirect-to&quot;</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>Връщане на HTML</h1></hgroup>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HTMl</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/sample-html&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// казваме на браузъра, че ще получи HTML</span>
            <span class="n">response</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="s">&quot;text/html&quot;</span><span class="o">);</span>
            <span class="k">return</span> <span class="s">&quot;&lt;html&gt;&lt;h1&gt;Example&lt;/h1&gt;&lt;/html&gt;&quot;</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>Статични файлове</h1></hgroup>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">static</span> <span class="n">spark</span><span class="o">.</span><span class="na">Spark</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">StaticResources</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// Ще сервира всички файлове под пътя /public</span>
        <span class="c1">// Като използваме Maven, /public == /main/resources</span>
        <span class="n">staticFileLocation</span><span class="o">(</span><span class="s">&quot;/public&quot;</span><span class="o">);</span>

        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/hello&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>HTTP кодове</h1></hgroup>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">static</span> <span class="n">spark</span><span class="o">.</span><span class="na">Spark</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NotFound</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">get</span><span class="o">(</span><span class="s">&quot;/missing&quot;</span><span class="o">,</span> <span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">response</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="mi">404</span><span class="o">);</span>
            <span class="k">return</span> <span class="s">&quot;This is not the page you are looking for&quot;</span><span class="o">;</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>Помощни линкове</h1></hgroup>
<ul><li><a href="http://sparkjava.com/documentation.html" target="_blank">SparkJava</a></li><li><a href="https://github.com/perwendel/spark" target="_blank">Spark Github</a></li><li><a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop" target="blank">Postman</a></li></ul></section>
<section>
<hgroup><h1>Демо Проект</h1></hgroup>
<ul><li><a href="https://goo.gl/cbhMm3"><h1>https://goo.gl/cbhMm3</h1></a></li></ul><p>Изпълнете `mvn install`, за да инсталирате зависимостите</p></section>
<section>
<hgroup><h1>Задача</h1></hgroup>
<ul><li class="action">Система за събиране на мнения за избираеми дисциплини.</li><li class="action">Всяка избираема дисциплина си има страница.</li><li class="action">На страницата има информация за дисциплината и коментари за нея.</li><li class="action">През семестъра ще създадем такава система от начало до край.</li><li class="action">Всяко упражнение ще подобрява системата.</li></ul></section>
<section>
<hgroup><h1>Задача 1</h1></hgroup>
<p>Имплементирайте метода toHTML() на класа Elective, който показва информация за даден курс.</p><p>Ще намерите всичко необходимо в демо проекта.</p><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">Elective</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toHTML</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// TODO: Implement</span>
        <span class="k">return</span> <span class="s">&quot;&lt;h1&gt;Foo Bar&lt;/h1&gt;&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre>
</div>
</section>
<section>
<hgroup><h1>Задача 1</h1></hgroup>
<p>Пример, следното извикване:</p><div class="highlight"><pre><span></span><span class="n">Elective</span> <span class="n">go</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Elective</span><span class="o">(</span><span class="s">&quot;Програмиране с Go&quot;</span><span class="o">,</span> <span class="s">&quot;...&quot;</span><span class="o">,</span> <span class="s">&quot;Николай Бачийски&quot;</span><span class="o">);</span>
<span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="na">toHTML</span><span class="o">();</span>
</pre>
</div>
<p>Tрябва да върне следния низ:</p><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Програмиране с Go<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Николай Бачийски<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre>
</div>
<p>Като в h1 се намира 'title' информацията, в h2 се намира 'lecturer' информацията, а в параграф се показва 'description' информацията за курса.</p><p>В предаденото решение не трябва да има нов ред или празно място между html таговете.</p></section>
<section>
<hgroup><h1>Задача 2</h1></hgroup>
<p>Имплементирайте route handler, който при извикване на "/electives/:elective" да връща toHTML() на съответния избираем предмет.</p><p>Използвайте за примерни данни data HashMap-a от примерния проект.</p><p>При повикване с липсващ или несъществуващ параметър трябва да изведе съобщението "Несъществуваща дисциплина" и да върне HTTP код 404</p></section>
<section>
<hgroup><h1>Задача 2</h1></hgroup>
<p>Пример: при зареждане на "http://localhost:4567/electives/go" трябва да изведе "toHTML()" на HashMap.get("go");</p><p>При зареждане на "http://localhost:4567/electives/missing" трябва да върне 404 и да изведе "Несъществуваща дисциплина"</p></section>
<section>
<hgroup><h1>Задача 3</h1></hgroup>
<p>Добавете лого(картинка) към изборните дисциплини и го отразете в toHTML()</p><p>Пример </p><div class="highlight"><pre><span></span><span class="n">Elective</span> <span class="n">electiveWithImage</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Elective</span><span class="o">(</span><span class="s">&quot;Foo&quot;</span><span class="o">,</span> <span class="s">&quot;Bar&quot;</span><span class="o">,</span> <span class="s">&quot;Baz&quot;</span><span class="o">,</span> <span class="s">&quot;/images/elective-logo.png&quot;</span><span class="o">);</span>
</pre>
</div>
</section>
</div><script src="js/jquery-1.5.2.min.js"></script><script src="js/jquery.jswipe-0.1.2.js"></script><script src="js/htmlSlides.js"></script><script src="js/pusher.js"></script><script type="text/javascript">$(function() {
  htmlSlides.init({ hideToolbar: true });
});

var pusher = new Pusher('a2024b659f492cab86cc');
pusher.subscribe('lectures');
pusher.bind('refresh', function(data) {
  location.reload(true);
});

try {
  mixpanel.track('Landing Page', {
    referrer: document.referrer,
    presentation: document.title
  });
} catch (e) {};</script></body></html>